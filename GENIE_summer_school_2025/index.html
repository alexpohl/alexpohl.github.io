<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Alexandre  POHL | cGENIE summer school 2025</title>
<meta name="description" content="None
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="/assets/github.css"/>

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåç</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/GENIE_summer_school_2025/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Alexandre</span>   POHL
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/Contact/">
                Contact
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/Presentations/">
                Presentations
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/Publications/">
                Publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/research/">
                Research
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/Materials/">
                Research materials
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/Resume/">
                Resume
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">cGENIE summer school 2025</h1>
    <p class="post-description">Instructions to connect to the CCUB cluster and get GENIE running</p>
  </header>

  <article style="font-size: 0.85rem;">
    <h2 id="connecting-to-the-cluster-of-univ-bourgogne-europe-with-nomachine">Connecting to the cluster of Univ. Bourgogne Europe with NoMachine</h2>

<p>NoMachine permits working on a remote Linux cluster with a graphical interface by generating a Desktop just like on your local computer. It notably permits opening a file explorer and easily displaying figures or even working interactively on Matlab, Spyder (Python) or Rstudio.</p>

<p>Instructions to obtain and configure NoMachine for the CCUB cluster can be found on [<a href="https://ccub.u-bourgogne.fr/dnum-ccub/spip.php?article961" target="_blank">this webpage</a>].</p>

<p>Then:</p>
<ul>
  <li>Open the <code class="language-plaintext highlighter-rouge">NoMachine</code> app.</li>
  <li>Use your CCUB login and password to connect.</li>
  <li>You are ready to open a terminal window to work (Menu &gt; Emulateur de terminal); would you be given a choice, choose the terminal called Xfce, which is black by default.</li>
  <li>When needed, you can use the local <code class="language-plaintext highlighter-rouge">FileZilla</code> application to transfer files between the local computer and the remote cluster using a graphical interface.</li>
</ul>

<p><strong>Remark:</strong> it is also possible to just connect without graphical interface through ssh:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh -Y -C -o StrictHostKeyChecking=no CCUBlogin@krenek2002.u-bourgogne.fr
</code></pre></div></div>
<p>‚Ä¶ and to transfer files between the cluster and your local computer through scp.</p>

<p>&nbsp;</p>

<h2 id="downloading-and-installing-cgenie">Downloading and installing cGENIE</h2>

<h3 id="go-to-the-workdir-this-is-where-the-model-is-going-to-run">Go to the workdir (this is where the model is going to run)</h3>

<p><code class="language-plaintext highlighter-rouge">cd /work/c-ccub/CCUBlogin</code> (with CCUBlogin, your CCUB login)</p>

<h3 id="downloading-model-source-code">Downloading model source code</h3>

<p><code class="language-plaintext highlighter-rouge">git clone https://github.com/derpycode/cgenie.muffin.git</code></p>

<h3 id="installing-by-adapting-to-ccub">Installing (by adapting to CCUB)</h3>

<ol>
  <li><code class="language-plaintext highlighter-rouge">cd cgenie.muffin/</code></li>
  <li><code class="language-plaintext highlighter-rouge">git checkout UBE25</code></li>
  <li><code class="language-plaintext highlighter-rouge">chmod 744 install_on_CCUB.sh</code></li>
  <li>Adapt file <code class="language-plaintext highlighter-rouge">install_on_CCUB.sh</code> (first line) with your own CCUB login</li>
  <li><code class="language-plaintext highlighter-rouge">./install_on_CCUB.sh</code></li>
</ol>

<h3 id="sourcing-the-kshrc-file">Sourcing the .kshrc file</h3>

<p>Before moving forward, we‚Äôll need to close the terminal and open a new one. (This permits sourcing the <code class="language-plaintext highlighter-rouge">.kshrc</code> file that we just created.)</p>

<h3 id="checking-everything-works-well">Checking everything works well</h3>

<p>After opening a new terminal window:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">cd /work/c-ccub/CCUBlogin/cgenie.muffin/genie-main</code></li>
  <li><code class="language-plaintext highlighter-rouge">make cleanall</code></li>
  <li><code class="language-plaintext highlighter-rouge">geniemod</code></li>
  <li><code class="language-plaintext highlighter-rouge">make testbiogem</code>(that should not output any error, and give <code class="language-plaintext highlighter-rouge">**TEST OK**</code> as a result).</li>
</ol>

<h3 id="running-a-simulation">Running a simulation</h3>

<p>Running GENIE consists in (creating the appropriate files) and launching an instruction from <code class="language-plaintext highlighter-rouge">genie-main</code> (<code class="language-plaintext highlighter-rouge">cd /work/c-ccub/CCUBlogin/cgenie.muffin/genie-main</code>).</p>

<p>An instruction is in the form:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./runmuffin.sh base-config directory user-config duration
</code></pre></div></div>
<p>with:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">base-config</code>: the name of the base-config file, which contains the basic information regarding the model simulation, such as paleogeography, model components, biogeochemical tracers etc. The file extension <code class="language-plaintext highlighter-rouge">.config</code> should be omitted in the instruction.</li>
  <li><code class="language-plaintext highlighter-rouge">directory</code>: the name of the subdirectory containing the user-config file.</li>
  <li><code class="language-plaintext highlighter-rouge">user-config</code>: the name of the user-config file, which contains additional model parameters.</li>
  <li><code class="language-plaintext highlighter-rouge">duration</code>: the run duration in years.</li>
</ul>

<p>As an example of running GENIE:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./runmuffin.sh cgenie.eb_go_gs_ac_bg.worjh2.BASEFePRE14Crbcolx PUBS/submitted/Tetard_et_al.Nature.2023 SPIN.worjh2.Fe14C.preAge.Dye.pO2 20000
</code></pre></div></div>
<p>(don‚Äôt forget to run the commands <code class="language-plaintext highlighter-rouge">make cleanall</code> and <code class="language-plaintext highlighter-rouge">geniemod</code> like we did above before launching the simulation)</p>

<p>The model executable should compile, the simulation should start and you should see the model run. Because the model takes hours to days to run, we do not run it interactively like this but instead launch the simulations in batch mode. To this end, first cancel the ongoing model execution by using <code class="language-plaintext highlighter-rouge">Ctrl+C</code>, then use the following command:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qsub -m n -N test -q batch@bartok* -pe dmp* 1 -j y -o /work/c-ccub/CCUBlogin/cgenie_log -V -S /bin/bash runmuffin.sh‚Ä¶ [see instruction above]
</code></pre></div></div>

<p>Note that, as a baseline, you will have to run each new simulation interactively for a few years (<code class="language-plaintext highlighter-rouge">./runmuffin.sh...</code>) before being able to submit it in batch mode (<code class="language-plaintext highlighter-rouge">qsub...</code>). This is because the interactive step permits compiling the code and creating an executable that is required for the model to run in batch mode.</p>

<p>You can check that a simulation is running: the <code class="language-plaintext highlighter-rouge">qstat</code> command should show the name of the simulation (the one you gave using the <code class="language-plaintext highlighter-rouge">-N</code> argument of the <code class="language-plaintext highlighter-rouge">qsub</code>command, <code class="language-plaintext highlighter-rouge">test</code> in the case above), and you should be able to access the output (<code class="language-plaintext highlighter-rouge">cd /work/c-ccub/CCUBlogin/cgenie_output/SPIN.worjh2.Fe14C.preAge.Dye.pO2</code>)</p>

<h3 id="looking-at-the-output">Looking at the output</h3>

<p>The GENIE output of interest is located in the GENIE simulation output subdirectory <code class="language-plaintext highlighter-rouge">biogem</code>. It consists in 2D and 3D NetCDF files (<code class="language-plaintext highlighter-rouge">fields_biogem_2d.nc</code> and <code class="language-plaintext highlighter-rouge">fields_biogem_3d.nc</code>) and time-series (<code class="language-plaintext highlighter-rouge">*.res</code> ascii files). They can be plotted using diverse software such as Python; for the purpose of this summer school, you are free to use what you feel the most at ease with but support will only be provided for <code class="language-plaintext highlighter-rouge">gnuplot</code> and <code class="language-plaintext highlighter-rouge">pyFerret</code>. Basic gnuplot and pyFerret scripts are provided in directory <code class="language-plaintext highlighter-rouge">cgenie.muffin/basic_scripts</code>. The gnuplot script permits plotting the .res time series. The pyFerret .jnl script can be used to explore the NetCDF files. To run these scripts, simply adapt them and run the commands <code class="language-plaintext highlighter-rouge">gnuplot plot_res_file.gnuplot</code> in the terminal, and <code class="language-plaintext highlighter-rouge">go plot.jnl</code> using the pyFerret prompt, respectively. To launch pyFerret (and open the Ferret prompt), just run the following commands: (i) <code class="language-plaintext highlighter-rouge">pyferretmod</code> (which permits loading the right modules), and (ii) <code class="language-plaintext highlighter-rouge">pyferret</code> (which starts pyFerret). Please note that, in order to be able to run pyFerret, you may have to install missing python libraries by running commands like <code class="language-plaintext highlighter-rouge">python -m pip install --user readline</code>.</p>

<p>It is also possible to download the GENIE NetCDF output and look at it using Panoply on your local computer.</p>

<h3 id="genie-output-example">GENIE output example</h3>

<p>Example GENIE output files can be downloaded using the following command line:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget "https://sdrive.cnrs.fr/s/y7kCN9562j8RGA3/download/GENIE_results_example.tar.gz"
</code></pre></div></div>

<p>First uncompress the archive:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tar xfvz GENIE_results_example.tar.gz
</code></pre></div></div>

<p>This will give you a directory <code class="language-plaintext highlighter-rouge">GENIE_results_example</code> containing three items:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">AP.muffin.CB.GIteiiaa.BASESFeTDTL_rb.SPIN</code> is a GENIE (spinup) preindustrial simulation that was run for 20 000 years.</li>
  <li><code class="language-plaintext highlighter-rouge">AP.muffin.CB.GIteiiva.BASESFeTDTL_rb_DO0.0.SPIN</code> is a GENIE (spinup) simulation for the Last Glacial Maximum that was also run for 20 000 years.</li>
  <li><code class="language-plaintext highlighter-rouge">1_woa23_all_o00_01_regridded_GIteiiaa.nc</code> is the modern oceanic dissolved oxygen concentration from the World Ocean Atlas 2023 regridded to the GENIE grid.</li>
</ul>

<h2 id="material-for-case-studies">Material for case studies</h2>

<p>User-config files made available for the case studies are located in directory <code class="language-plaintext highlighter-rouge">cgenie.muffin/genie-userconfigs/UBgraduateprogramme</code>.</p>


  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2025 Alexandre  POHL.
    
    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
